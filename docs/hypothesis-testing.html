<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 7 Hypothesis Testing | MA-500: Introduction to R</title>
<meta name="author" content="Regina-Mae Dominguez - Fall 2024">
<meta name="generator" content="bookdown 0.40 with bs4_book()">
<meta property="og:title" content="Chapter 7 Hypothesis Testing | MA-500: Introduction to R">
<meta property="og:type" content="book">
<meta property="og:image" content="/images/cover.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 7 Hypothesis Testing | MA-500: Introduction to R">
<meta name="twitter:image" content="/images/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<meta name="description" content="Today, we are going to go over some concepts of Hypothesis Testing, specifically the Student’s t-test and Analysis of Variance (ANOVA).  7.0.0.1 Assumptions of T-Test Independence of Observations...">
<meta property="og:description" content="Today, we are going to go over some concepts of Hypothesis Testing, specifically the Student’s t-test and Analysis of Variance (ANOVA).  7.0.0.1 Assumptions of T-Test Independence of Observations...">
<meta name="twitter:description" content="Today, we are going to go over some concepts of Hypothesis Testing, specifically the Student’s t-test and Analysis of Variance (ANOVA).  7.0.0.1 Assumptions of T-Test Independence of Observations...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <img id="cover" class="d-none d-lg-block" src="images/cover-small.png"><br><h1>
        <a href="index.html" title="">MA-500: Introduction to R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">MA-500: Introduction to R</a></li>
<li><a class="" href="rrstudio-installation-guide.html">R/RStudio Installation Guide</a></li>
<li><a class="" href="r-scriptscode.html">R-Scripts/Code</a></li>
<li><a class="" href="r-basics-and-fundamentals.html"><span class="header-section-number">1</span> R Basics and Fundamentals</a></li>
<li><a class="" href="conditionals-loops-and-functions.html"><span class="header-section-number">2</span> Conditionals, Loops, and Functions</a></li>
<li><a class="" href="introduction-to-dataframes-ggplot2.html"><span class="header-section-number">3</span> Introduction to Dataframes &amp; ggplot2</a></li>
<li><a class="" href="data-visualizations.html"><span class="header-section-number">4</span> Data Visualizations</a></li>
<li><a class="" href="statistics.html"><span class="header-section-number">5</span> Statistics</a></li>
<li><a class="" href="probability.html"><span class="header-section-number">6</span> Probability</a></li>
<li><a class="active" href="hypothesis-testing.html"><span class="header-section-number">7</span> Hypothesis Testing</a></li>
<li><a class="" href="useful-tips.html">Useful Tips</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="hypothesis-testing" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Hypothesis Testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing"><i class="fas fa-link"></i></a>
</h1>
<p>Today, we are going to go over some concepts of Hypothesis Testing, specifically the Student’s t-test and Analysis of Variance (ANOVA).</p>
<div id="assumptions-of-t-test" class="section level4" number="7.0.0.1">
<h4>
<span class="header-section-number">7.0.0.1</span> Assumptions of T-Test<a class="anchor" aria-label="anchor" href="#assumptions-of-t-test"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p>Independence of Observations</p></li>
<li><p>Normality of the Dependent Variable</p></li>
<li><p>Equal Variances (Homogeneity of Variance)</p></li>
</ul>
</div>
<div id="assumptions-of-anova" class="section level4" number="7.0.0.2">
<h4>
<span class="header-section-number">7.0.0.2</span> Assumptions of ANOVA<a class="anchor" aria-label="anchor" href="#assumptions-of-anova"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p>Independence of Observations</p></li>
<li><p>Normality of the Dependent Variable</p></li>
<li><p>Equal Variances (Homogeneity of Variance)</p></li>
</ul>
<p>We will be using the <strong>mock_outplanting_data.csv</strong> file available on Moodle. This dataset contains simulated height measurements (in centimeters) of three different plant species native to Guam, collected on two separate dates. Please note that these height values are simulated to maintain data privacy.</p>
<div class="sourceCode" id="cb251"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load in packages needed</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://personality-project.org/r/psych/">psych</a></span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: package 'psych' was built under R version 4.3.3</code></pre>
<div class="sourceCode" id="cb253"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"/Users/rdominguez/MA500/mock_outplanting_data.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># familarize with the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   id    Date    Species             Height
##   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;                &lt;dbl&gt;
## 1 Pa1   2020-04 Pandanus tectorius    40.4
## 2 Pr1   2020-04 Premna.serratifolia   28.2
## 3 Ix1   2020-04 Ixora.triantha        18.2
## 4 Pa2   2020-04 Pandanus tectorius    31.5
## 5 Pr2   2020-04 Premna.serratifolia   38.8
## 6 Ix2   2020-04 Ixora.triantha        20.1</code></pre>
<div class="sourceCode" id="cb255"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code>##       id                Date             Species              Height      
##  Length:300         Length:300         Length:300         Min.   :-11.23  
##  Class :character   Class :character   Class :character   1st Qu.: 27.06  
##  Mode  :character   Mode  :character   Mode  :character   Median : 38.86  
##                                                           Mean   : 61.18  
##                                                           3rd Qu.:100.71  
##                                                           Max.   :198.56</code></pre>
<p>If you take a look at the summary, we see that there is a minimum value of Height that is <code>-11.23</code>. We do know that height should be positive, so let’s move forward believing this in an error in data inputting and remove this from our analysis.</p>
<div class="sourceCode" id="cb257"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Height</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>We have to do a bit of data cleaning with this dataset. If you look at the unique values of Species, you will notice that there are multiple typos/spelling errors for each species. We want to make sure we correct that before we move forward with our analysis.</p>
<p>We will fix these errors by using the <code>grepl</code> function. <code><a href="https://rdrr.io/r/base/grep.html">grepl()</a></code> in R is a function used for pattern matching within strings. It checks whether a specific pattern (regular expression) exists in each element of a character vector, and returns a logical vector (<code>TRUE</code> or <code>FALSE</code>) indicating whether the pattern was found in each element.</p>
<p>The below code searches for each value in the <code>Species</code> column that matches the specified pattern, <code>Pan</code> for <em>Pandanus tectorius,</em> <code>Pre</code> for <em>Premna serratifolia,</em> and <code>Ix</code> for <em>Ixora triantha,</em> then overwrites all the values that match the pattern to the correct spelling we would like.</p>
<div class="sourceCode" id="cb258"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># recoding Pandanus</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Species</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Pan"</span>, <span class="va">df</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "Pandanus tectorius" "Pandanus.tectorius" "Pandaus tectorius"</code></pre>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">Species</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Pan"</span>, <span class="va">df</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Pandanus tectorius"</span></span>
<span></span>
<span></span>
<span><span class="co"># recoding Premna</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Species</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Pre"</span>, <span class="va">df</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "Premna.serratifolia" "Premna serratifolia" "Prenna serratifolia"
## [4] "Premma Serratifolia" "Premma serratifolia"</code></pre>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">Species</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Pre"</span>, <span class="va">df</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Premna serratifolia"</span></span>
<span></span>
<span><span class="co"># recoding Ixora</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">Species</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Ix"</span>, <span class="va">df</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Ixora triantha"</span></span></code></pre></div>
</div>
<div id="visualizing-datadiagnostics" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Visualizing Data/Diagnostics<a class="anchor" aria-label="anchor" href="#visualizing-datadiagnostics"><i class="fas fa-link"></i></a>
</h2>
<p>Before proceeding with hypothesis testing or assessing statistical significance, it’s important to first ensure that our data meets the assumptions required for the tests we plan to use. If the assumptions are not met, we may need to explore alternative approaches or adjustments to address the issue.</p>
<p>The diagnostics here primarily involve examining the distribution of the data within the groups we intend to test. This includes generating density plots with histograms, creating QQ plots, and constructing box plots. These visual tools provide valuable insights into the overall characteristics and distribution of the data.</p>
<div class="sourceCode" id="cb263"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we are subsetting to just the first date given in our</span></span>
<span><span class="co"># dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "2020-04" "2021-09"</code></pre>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_day1</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Date</span> <span class="op">==</span> <span class="st">"2020-04"</span><span class="op">)</span></span></code></pre></div>
<div id="creating-a-density-plot" class="section level3" number="7.1.1">
<h3>
<span class="header-section-number">7.1.1</span> Creating a Density Plot<a class="anchor" aria-label="anchor" href="#creating-a-density-plot"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># normality diagnostics</span></span>
<span><span class="va">dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_day1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Height</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    binwidth <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Species</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">dens</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="intro_r_course_files/figure-html/unnamed-chunk-135-1.png" width="672"></div>
<p>From the density plot, we can compare the means of each group visually. From observation, we can see that <em>Pandanus tectorius</em> has a wider spread of data (meaning a higher variance value) and the means of <em>Ixora triantha</em> and <em>Premna serratifolia</em> differ. Each distribution separately (by species) however does look to follow normal distribution.</p>
</div>
<div id="creating-a-qq-plot-for-each-group" class="section level3" number="7.1.2">
<h3>
<span class="header-section-number">7.1.2</span> Creating a QQ plot for each group<a class="anchor" aria-label="anchor" href="#creating-a-qq-plot-for-each-group"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb267"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">df_day1</span><span class="op">$</span><span class="va">Height</span><span class="op">[</span><span class="va">df_day1</span><span class="op">$</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"Ixora triantha"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">df_day1</span><span class="op">$</span><span class="va">Height</span><span class="op">[</span><span class="va">df_day1</span><span class="op">$</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"Ixora triantha"</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="intro_r_course_files/figure-html/unnamed-chunk-136-1.png" width="672"></div>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">df_day1</span><span class="op">$</span><span class="va">Height</span><span class="op">[</span><span class="va">df_day1</span><span class="op">$</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"Pandanus tectorius"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">df_day1</span><span class="op">$</span><span class="va">Height</span><span class="op">[</span><span class="va">df_day1</span><span class="op">$</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"Pandanus tectorius"</span><span class="op">]</span>,</span>
<span>    col <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="intro_r_course_files/figure-html/unnamed-chunk-136-2.png" width="672"></div>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">df_day1</span><span class="op">$</span><span class="va">Height</span><span class="op">[</span><span class="va">df_day1</span><span class="op">$</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"Premna serratifolia"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">df_day1</span><span class="op">$</span><span class="va">Height</span><span class="op">[</span><span class="va">df_day1</span><span class="op">$</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"Premna serratifolia"</span><span class="op">]</span>,</span>
<span>    col <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="intro_r_course_files/figure-html/unnamed-chunk-136-3.png" width="672"></div>
<p>Creating a qqplot also reinforces that our data looks normal!</p>
</div>
<div id="creating-a-boxplot-for-each-group" class="section level3" number="7.1.3">
<h3>
<span class="header-section-number">7.1.3</span> Creating a boxplot for each group<a class="anchor" aria-label="anchor" href="#creating-a-boxplot-for-each-group"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb270"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_day1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Species</span>, y <span class="op">=</span> <span class="va">Height</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">bp</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="intro_r_course_files/figure-html/unnamed-chunk-137-1.png" width="672"></div>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/describe.by.html">describeBy</a></span><span class="op">(</span><span class="va">df_day1</span>, group <span class="op">=</span> <span class="va">df_day1</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Descriptive statistics by group 
## group: Ixora triantha
##         vars  n  mean    sd median trimmed   mad   min   max range skew
## id         1 50 25.50 14.58  25.50    25.5 18.53  1.00 50.00  49.0 0.00
## Date       2 50  1.00  0.00   1.00     1.0  0.00  1.00  1.00   0.0  NaN
## Species    3 50  1.00  0.00   1.00     1.0  0.00  1.00  1.00   0.0  NaN
## Height     4 50 21.31  6.30  19.88    21.1  6.79 10.16 35.66  25.5 0.31
##         kurtosis   se
## id         -1.27 2.06
## Date         NaN 0.00
## Species      NaN 0.00
## Height     -0.76 0.89
## ------------------------------------------------------------ 
## group: Pandanus tectorius
##         vars  n  mean    sd median trimmed   mad   min    max range  skew
## id         1 50 75.50 14.58  75.50   75.50 18.53 51.00 100.00 49.00  0.00
## Date       2 50  1.00  0.00   1.00    1.00  0.00  1.00   1.00  0.00   NaN
## Species    3 50  2.00  0.00   2.00    2.00  0.00  2.00   2.00  0.00   NaN
## Height     4 50 42.24 12.50  41.15   42.32 12.33  6.24  71.46 65.22 -0.18
##         kurtosis   se
## id         -1.27 2.06
## Date         NaN 0.00
## Species      NaN 0.00
## Height      0.32 1.77
## ------------------------------------------------------------ 
## group: Premna serratifolia
##         vars  n   mean    sd median trimmed   mad min    max range  skew
## id         1 50 125.50 14.58  125.5   125.5 18.53 101 150.00 49.00  0.00
## Date       2 50   1.00  0.00    1.0     1.0  0.00   1   1.00  0.00   NaN
## Species    3 50   3.00  0.00    3.0     3.0  0.00   3   3.00  0.00   NaN
## Height     4 50  31.96  7.30   32.2    32.2  5.98  12  45.38 33.39 -0.33
##         kurtosis   se
## id         -1.27 2.06
## Date         NaN 0.00
## Species      NaN 0.00
## Height     -0.09 1.03</code></pre>
</div>
</div>
<div id="running-two-sample-t-test" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Running two-sample t-test<a class="anchor" aria-label="anchor" href="#running-two-sample-t-test"><i class="fas fa-link"></i></a>
</h2>
<p>Let’s test if the means between the heights of <em>Pandanus tectorius</em> and <em>Ixora triantha</em> are different, ie</p>
<p><span class="math display">\[
H_0: \mu_{1} - \mu_{2} = 0 \\
H_A: \mu_{1} - \mu_{2} \neq 0
\]</span></p>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">two_samp</span> <span class="op">&lt;-</span> <span class="va">df_day1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">!=</span> <span class="st">"Premna serratifolia"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">two_samp</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "Pandanus tectorius" "Ixora triantha"</code></pre>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Height</span> <span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">two_samp</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Height by Species
## t = -10.567, df = 72.407, p-value = 2.547e-16
## alternative hypothesis: true difference in means between group Ixora triantha and group Pandanus tectorius is not equal to 0
## 95 percent confidence interval:
##  -24.87278 -16.97826
## sample estimates:
##     mean in group Ixora triantha mean in group Pandanus tectorius 
##                         21.31458                         42.24010</code></pre>
<p>Then test if the means of <em>Pandanus tectorius</em> is greater than <em>Ixora triantha</em>, ie</p>
<p><span class="math display">\[
H_0: \mu_1 - \mu_2 = 0 \\
H_A: \mu_1 - \mu_2 &gt;0
\]</span></p>
<div class="sourceCode" id="cb277"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># is ixora mean &gt; pandanus mean?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Height</span> <span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">two_samp</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Height by Species
## t = -10.567, df = 72.407, p-value = 1
## alternative hypothesis: true difference in means between group Ixora triantha and group Pandanus tectorius is greater than 0
## 95 percent confidence interval:
##  -24.22502       Inf
## sample estimates:
##     mean in group Ixora triantha mean in group Pandanus tectorius 
##                         21.31458                         42.24010</code></pre>
<div class="sourceCode" id="cb279"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># is ixora mean &lt; pandanus mean?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Height</span> <span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">two_samp</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Height by Species
## t = -10.567, df = 72.407, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means between group Ixora triantha and group Pandanus tectorius is less than 0
## 95 percent confidence interval:
##       -Inf -17.62601
## sample estimates:
##     mean in group Ixora triantha mean in group Pandanus tectorius 
##                         21.31458                         42.24010</code></pre>
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">two_samp</span><span class="op">$</span><span class="va">Height</span><span class="op">[</span><span class="va">two_samp</span><span class="op">$</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"Pandanus tectorius"</span><span class="op">]</span>,</span>
<span>    y <span class="op">=</span> <span class="va">two_samp</span><span class="op">$</span><span class="va">Height</span><span class="op">[</span><span class="va">two_samp</span><span class="op">$</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"Ixora triantha"</span><span class="op">]</span>,</span>
<span>    alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  two_samp$Height[two_samp$Species == "Pandanus tectorius"] and two_samp$Height[two_samp$Species == "Ixora triantha"]
## t = 10.567, df = 72.407, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is greater than 0
## 95 percent confidence interval:
##  17.62601      Inf
## sample estimates:
## mean of x mean of y 
##  42.24010  21.31458</code></pre>
<p>Based on the results above, we can reject both null hypotheses and say that there does exist a difference in the mean heights between <em>Pandanus tectorius</em> and <em>Ixora triantha (p &lt;</em> 2.547e-16) and that the mean height for <em>Pandanus tectorius</em> is greater than the mean height for <em>Ixora triantha (p &lt;</em> 2.2e-16)<em>.</em></p>
<p><strong>BIG NOTE: If we ran a two-sample t-test comparing the mean height for <em>Ixora triantha</em> and <em>Premna serratifolia,</em> we can run the standard two-sample t-test due to their variances being approximately equal (another way to check is if: their ratio (var(group1)/var(group2) &lt; 2).</strong></p>
</div>
<div id="running-a-paired-t-test" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Running a paired t-test<a class="anchor" aria-label="anchor" href="#running-a-paired-t-test"><i class="fas fa-link"></i></a>
</h2>
<p>For this section, we will test if there is a difference in the means of heights for <em>Premna serratifolia</em> between the two recorded dates, ie</p>
<p><span class="math display">\[
H_0: \mu_d = 0 \\
H_A: \mu_d \neq 0
\]</span></p>
<div class="sourceCode" id="cb283"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prem</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">==</span> <span class="st">"Premna serratifolia"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prem_dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">prem</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Height</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    binwidth <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Date</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">Date</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">prem_dens</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="intro_r_course_files/figure-html/unnamed-chunk-142-1.png" width="672"></div>
<div class="sourceCode" id="cb285"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">prem</span><span class="op">$</span><span class="va">Height</span><span class="op">[</span><span class="va">prem</span><span class="op">$</span><span class="va">Date</span> <span class="op">==</span> <span class="st">"2020-04"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="intro_r_course_files/figure-html/unnamed-chunk-143-1.png" width="672"></div>
<div class="sourceCode" id="cb286"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">prem</span><span class="op">$</span><span class="va">Height</span><span class="op">[</span><span class="va">prem</span><span class="op">$</span><span class="va">Date</span> <span class="op">==</span> <span class="st">"2021-09"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="intro_r_course_files/figure-html/unnamed-chunk-143-2.png" width="672"></div>
<p>Let’s move forward and pivot our dataset so that we can see the heights by date side-by-side. This will help you visually see how each specific plant (which is uniquely identified by <code>id</code>) changes between the two dates.</p>
<div class="sourceCode" id="cb287"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prem_wide</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">prem</span>, id_cols <span class="op">=</span> <span class="st">"id"</span>, names_from <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>    values_from <span class="op">=</span> <span class="st">"Height"</span><span class="op">)</span></span>
<span><span class="va">prem_wide</span> <span class="op">&lt;-</span> <span class="va">prem_wide</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="va">`2021-09`</span> <span class="op">-</span> <span class="va">`2020-04`</span><span class="op">)</span></span>
<span><span class="va">prem_wide</span> <span class="op">&lt;-</span> <span class="va">prem_wide</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>before <span class="op">=</span> <span class="va">`2020-04`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>after <span class="op">=</span> <span class="va">`2021-09`</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">prem_wide</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   id    before after  diff
##   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Pr1     28.2 125.   96.3
## 2 Pr2     38.8 120.   80.7
## 3 Pr3     38.9  72.0  33.0
## 4 Pr4     12.0 118.  106. 
## 5 Pr5     29.4  68.0  38.6
## 6 Pr6     27.4 157.  129.</code></pre>
<div class="sourceCode" id="cb289"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># running a paired t-test, make sure the paired argument is</span></span>
<span><span class="co"># TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">prem_wide</span><span class="op">$</span><span class="va">after</span>, y <span class="op">=</span> <span class="va">prem_wide</span><span class="op">$</span><span class="va">before</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  prem_wide$after and prem_wide$before
## t = 21.319, df = 49, p-value &lt; 2.2e-16
## alternative hypothesis: true mean difference is not equal to 0
## 95 percent confidence interval:
##   88.4927 106.9122
## sample estimates:
## mean difference 
##        97.70243</code></pre>
<p>The t-test results above show a p-value less than 0.05, meaning we can reject the null hypothesis that the mean difference between the heights on the first recorded day and the last recorded day is 0.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="probability.html"><span class="header-section-number">6</span> Probability</a></div>
<div class="next"><a href="useful-tips.html">Useful Tips</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#hypothesis-testing"><span class="header-section-number">7</span> Hypothesis Testing</a></li>
<li>
<a class="nav-link" href="#visualizing-datadiagnostics"><span class="header-section-number">7.1</span> Visualizing Data/Diagnostics</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#creating-a-density-plot"><span class="header-section-number">7.1.1</span> Creating a Density Plot</a></li>
<li><a class="nav-link" href="#creating-a-qq-plot-for-each-group"><span class="header-section-number">7.1.2</span> Creating a QQ plot for each group</a></li>
<li><a class="nav-link" href="#creating-a-boxplot-for-each-group"><span class="header-section-number">7.1.3</span> Creating a boxplot for each group</a></li>
</ul>
</li>
<li><a class="nav-link" href="#running-two-sample-t-test"><span class="header-section-number">7.2</span> Running two-sample t-test</a></li>
<li><a class="nav-link" href="#running-a-paired-t-test"><span class="header-section-number">7.3</span> Running a paired t-test</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
